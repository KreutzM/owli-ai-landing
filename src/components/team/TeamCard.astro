---
import type { CollectionEntry } from "astro:content";
import type { SiteLang } from "../../lib/i18n";

interface Props {
  member: CollectionEntry<"team">;
  lang?: SiteLang;
}

const { member, lang = "de" } = Astro.props;
const copy = {
  de: {
    portraitPrefix: "Portrait von"
  },
  en: {
    portraitPrefix: "Portrait of"
  },
  es: {
    portraitPrefix: "Retrato de"
  }
}[lang];

const initials = member.data.name
  .split(" ")
  .filter(Boolean)
  .slice(0, 2)
  .map((part) => part[0]?.toUpperCase() ?? "")
  .join("");
---

<article class="flex h-full flex-col rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
  <div class="mb-4 flex items-start gap-4">
    {
      member.data.image ? (
        <img
          src={member.data.image}
          alt={`${copy.portraitPrefix} ${member.data.name}`}
          width="128"
          height="128"
          class="h-20 w-20 shrink-0 rounded-full border border-slate-300 object-cover"
          loading="lazy"
          decoding="async"
        />
      ) : (
        <div
          class="flex h-20 w-20 shrink-0 items-center justify-center rounded-full border border-slate-300 bg-slate-100 text-lg font-semibold text-slate-700"
          aria-hidden="true"
        >
          {initials}
        </div>
      )
    }
    <div class="space-y-1">
      <h2 class="text-2xl font-semibold leading-tight tracking-tight">{member.data.name}</h2>
      <p class="text-sm font-medium text-slate-700">{member.data.role}</p>
      {member.data.organization && <p class="text-sm text-slate-600">{member.data.organization}</p>}
    </div>
  </div>

  {member.data.tags.length > 0 && (
    <ul class="mb-4 flex flex-wrap gap-2">
      {
        member.data.tags.map((tag) => (
          <li class="rounded-full border border-slate-300 bg-slate-50 px-2.5 py-1 text-xs font-semibold text-slate-700">{tag}</li>
        ))
      }
    </ul>
  )}

  <p class="flex-1 text-sm text-slate-700">{member.data.shortBio}</p>

  {member.data.links.thm && (
    <div class="mt-4 space-y-2">
      <a
        href={member.data.links.thm}
        target="_blank"
        rel="noopener noreferrer"
        class="btn-brand inline-flex items-center gap-2 rounded-full border px-4 py-2 text-sm font-semibold transition"
      >
        THM Profil
      </a>
      <p class="text-xs text-slate-600">Offizielles Profil bei der THM</p>
    </div>
  )}
</article>
