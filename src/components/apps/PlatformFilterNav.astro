---
import type { PlatformFilter } from "../../lib/content";
import { withPrefix, type LangPrefix, type SiteLang } from "../../lib/i18n";
import { getUiStrings } from "../../i18n/strings";

interface Props {
  active: PlatformFilter;
  androidCount?: number;
  windowsCount?: number;
  lang?: SiteLang;
  pathPrefix?: LangPrefix;
}

const { active, androidCount, windowsCount, lang = "de", pathPrefix = "" } = Astro.props;
const ui = getUiStrings(lang);

// Hide platform tabs when there are no apps for that platform.
// Keep the active tab visible to avoid confusing navigation states.
const showAndroid = androidCount === undefined ? true : androidCount > 0 || active === "android";
const showWindows = windowsCount === undefined ? true : windowsCount > 0 || active === "windows";

const filters = [
  { key: "all", label: ui.filter.all, href: withPrefix("/apps", pathPrefix) },
  ...(showAndroid ? [{ key: "android", label: ui.filter.android, href: withPrefix("/apps/platform/android", pathPrefix) } as const] : []),
  ...(showWindows ? [{ key: "windows", label: ui.filter.windows, href: withPrefix("/apps/platform/windows", pathPrefix) } as const] : [])
] as const;
---

<nav aria-label={ui.aria.appFilterByPlatform} class="rounded-2xl border border-slate-200 bg-white/90 p-2 shadow-sm backdrop-blur">
  <ul class="flex flex-wrap gap-2">
    {
      filters.map((filter) => (
        <li>
          <a
            href={filter.href}
            class:list={[
              "inline-flex rounded-full border px-4 py-2 text-sm font-medium transition",
              active === filter.key ? "tab-active border-transparent" : "border-transparent bg-slate-100 text-slate-800 hover:bg-slate-200"
            ]}
            aria-current={active === filter.key ? "page" : undefined}
          >
            {filter.label}
          </a>
        </li>
      ))
    }
  </ul>
</nav>
